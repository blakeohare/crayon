command = Crayon::TopLevelCheck()

if command.IsDisplayUsage
	Crayon::DisplayUsage()
endif

if command.IsGenerateDefaultProject
	Crayon::GenerateDefaultProject(command)
endif

if command.IsExportCbxVmBundle
	buildContext = Crayon::GetBuildContext(command)
	Exporter::ExportCbxVmBundle(command, buildContext)
endif

if command.IsExportStandaloneVm
	Exporter::ExportStandaloneVm(command)
endif

if command.IsExportStandaloneCbx
	Exporter::ExportStandaloneCbx(command)
endif

if command.IsRunCbx
	exporter = Exporter::ExportStandaloneCbx(command)
	cmdLineFlags = Crayon::RunCbxFlagBuilder(command, exporter)

	if command.ShowPerformance
		Crayon::ShowPerformanceMetrics()
	endif

	Crayon::RunCbx(cmdLineFlags)

	# Return now. Performance metrics have already been shown.
	return
endif

if command.ShowPerformance
	Crayon::ShowPerformanceMetrics()
endif
