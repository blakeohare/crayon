command = Crayon::TopLevelCheck()

if command.IsDisplayUsage
	Crayon::DisplayUsage()
endif

if command.IsGenerateDefaultProject
	Crayon::GenerateDefaultProject(command)
endif

if command.IsExportCbxVmBundle
	buildContext = Crayon::GetBuildContext(command)
	TODO_Export::ExportCbxVmBundle(command, buildContext)
endif

if command.IsExportStandaloneVm
	TODO_Export::ExportStandaloneVm(command)
endif

if command.IsExportStandaloneCbx
	TODO_Export::ExportStandaloneCbx(command)
endif

if command.IsRunCbx
	exporter = TODO_Export::ExportStandaloneCbx(command)
	cmdLineFlags = Crayon::RunCbxFlagBuilder(command, exporter)
	Crayon::RunCbx(cmdLineFlags)

	# Return now. Performance metrics should not be shown on RunCbx
	return
endif

if command.ShowPerformance
	Crayon::ShowPerformanceMetrics()
endif
